# https://www.youtube.com/watch?v=H70lULWJeig
unbind r
bind r source-file ~/.tmux.conf

set-option -g renumber-windows on
if-shell "[ -f /opt/homebrew/bin/fish ]" \
    'set-option -g default-shell /opt/homebrew/bin/fish' \
    'set-option -g default-shell /usr/local/bin/fish'
set -g prefix C-Space

setw -g mode-keys vi

# act like vim
# bind-key h select-pane -L
# bind-key j select-pane -D
# bind-key k select-pane -U
# bind-key l select-pane -R


# Easier key presses so you don't have to take
# your findger off ctrl

# Make it so i can also press
# eg. prefix + ctrl-n to switch to next window
# and prefix + ctrl-p to switch to previous window
bind-key C-n next-window
bind-key C-o select-pane -t :.+
bind-key C-space next-layout
bind-key C-p previous-window
bind-key C-c new-window
# Show sessions
bind-key C-s choose-session
bind-key C-w choose-window
bind-key C-, copy-mode 
bind-key C-r send-keys -t :.+ "r" Enter

# No confirmation on kill-window
bind-key x kill-window
bind-key C-x kill-window
bind-key l last-window
bind-key e select-window -t :-

# Save the scrollback buffer
# https://unix.stackexchange.com/questions/26548/write-all-tmux-scrollback-to-a-file
# bind-key P command-prompt -p 'save history to filename:' -I '/tmp/tmux.history' 'capture-pane -S -32768 ; save-buffer %1 ; delete-buffer'
bind-key P 'capture-pane -S -32768 ; save-buffer /tmp/tmux.history ; delete-buffer ; new-window "nvim +9999 /tmp/tmux.history"'
bind-key C-v 'capture-pane -S -32768 ; save-buffer /tmp/tmux.history ; delete-buffer ; new-window "nvim +9999 /tmp/tmux.history"'
# bind-key P run-shell 'tmux capture-pane -S -32768 \; save-buffer /tmp/tmux.history \; delete-buffer \; split-window -h "nvim /tmp/tmux.history"'




# https://gist.github.com/rsp/f4770a1fe8ea7e2378ac3a16e01a2b53
# unbind-key C-b
# set -g prefix 'C-\'
# bind-key 'C-\' send-prefix
# bind-key \ split-window -h
# bind-key / split-window -v

# Currently tmux intercepts C-9, C-0 and C-[
# This fix doesn't work
# bind -n C-9 send-keys C-9
# bind -n C-0 send-keys C-0

# https://gist.github.com/william8th/faf23d311fc842be698a1d80737d9631?permalink_comment_id=4260131#gistcomment-4260131
bind-key | split-window -h -c "#{pane_current_path}"
bind-key 'C-\' split-window -v -c "#{pane_current_path}"
bind-key \\ split-window -v -c "#{pane_current_path}"

# set-option xterm-keys off
# unbind -n S-Enter
# bind -n S-Enter display-message "Got shift enter"

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'christoomey/vim-tmux-navigator'
# set -g @plugin 'alexwforsythe/tmux-which-key'
set -g @plugin 'dracula/tmux'

set -g @dracula-plugins "battery cpu-usage ram-usage git"

# set -g @dracula-show-powerline true
# set -g @dracula-fixed-location "Australia/Sydney"
# set -g @dracula-plugins "weather"
set -g @dracula-show-left-icon session
# set -g status-position top

# initialize tmux plugin manager
# (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
